(Запрос) Как добавить в датафрейм столбец, так чтобы:
1) значение этого столбца равно "Элитная", если по столбцу "Цена" в этой строке значение > np.percentile(df['Цена квартиры(в млн)'], 75)
2) значение этого столбца "Дорогая", если по столбцу "Цена" в этой строке число < > np.percentile(df['Цена квартиры(в млн)'], 75) но больше > np.percentile(df['Цена квартиры(в млн)'], 50)
2) значение этого столбца "Дешёвая", если по столбцу "Цена" в этой строке число < > np.percentile(df['Цена квартиры(в млн)'], 50) но больше > np.percentile(df['Цена квартиры(в млн)'], 25)
3) как добавить в датафрейм столбец, так чтобы:
1) значение этого столбца равно "Элитная", если по столбцу "Цена" в этой строке значение > np.percentile(df['Цена квартиры(в млн)'], 75)
2) значение этого столбца "Дорогая", если по столбцу "Цена" в этой строке число < > np.percentile(df['Цена квартиры(в млн)'], 75) но больше > np.percentile(df['Цена квартиры(в млн)'], 50)
2) значение этого столбца "Дешёвая", если по столбцу "Цена" в этой строке число < > np.percentile(df['Цена квартиры(в млн)'], 50) но больше > np.percentile(df['Цена квартиры(в млн)'], 25)
3) значение этого столбца "Очень дешёвая", если по столбцу "Цена" в этой строке число меньше np.percentile(df['Цена квартиры(в млн)'], 25)



(Ответ) Для добавления столбца в датафрейм, удовлетворяющего указанным условиям, можно использовать метод apply() и условные выражения. Вот пример кода:

import pandas as pd
import numpy as np

# Создание датафрейма
df = pd.DataFrame({'Цена': [80, 120, 60, 150, 40, 100, 90]})

# Определение квантилей
q25 = np.percentile(df['Цена'], 25)
q50 = np.percentile(df['Цена'], 50)
q75 = np.percentile(df['Цена'], 75)

# Добавление нового столбца
df['Статус'] = df['Цена'].apply(lambda x: 'Элитная' if x > q75 else ('Дорогая' if x > q50 else ('Дешёвая' if x > q25 else 'Очень дешёвая')))

print(df)


В этом примере создается новый столбец "Статус" в датафрейме. Значение столбца определяется в соответствии с условиями: "Элитная" для значений больше 75-го перцентиля, "Дорогая" для значений больше 50-го перцентиля, "Дешёвая" для значений больше 25-го перцентиля и "Очень дешёвая" для значений меньше 25-го перцентиля.




